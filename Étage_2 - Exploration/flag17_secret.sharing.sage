from sage.rings.polynomial.polynomial_ring_constructor import PolynomialRing
from sage.rings.finite_rings.integer_mod_ring import Zmod

# Définition du corps fini Z/pZ
p = 2**64 - 59
R = PolynomialRing(Zmod(p), 'x')

# Points collectés et validés pour R et S
points_R = [(14443778476270776032, 1766537953861935607), (4252691253700062728, 17548906665387891003), (1612799020510557091, 11391616209831553192), (2686462251244805465, 6746415482905033472), (8807889986986045095, 10666015258086587003), (3665759966596187057, 15903321253697120136), (169109916801432616, 2932321957438184035), (9809520229429507012, 5942843848638220633), (6087676770165029145, 9743373905694400940)]
points_S = [(14443778476270776032, 14789107914769959347), (4252691253700062728, 14886335417332025869), (1612799020510557091, 12420725521987062215), (2686462251244805465, 9664951760414865117), (8807889986986045095, 13946631687319069001), (3665759966596187057, 8899160899838630352), (169109916801432616, 16504226998564273306), (9809520229429507012, 5367868107619219250), (6087676770165029145, 6421476239390240063), (3080237812682074906, 9065891112136224890), (8819653977247133022, 11719020273019018768), (5018527437871235147, 17816111851352766617), (3409075789537105652, 17365438782077944978), (9572167811206447647, 10996482880576980435), (11605551329257381285, 2242452430791209967), (4474201577882787578, 6896328982159026371), (16327984278128330803, 11295102725966416227)]

# Calcul des polynômes de Lagrange
poly_R = R.lagrange_polynomial(points_R)
poly_S = R.lagrange_polynomial(points_S)

# Extraction des clés
key_R = hex(int(poly_R(0)))
key_S = hex(int(poly_S(0)))

print(f"Clé R(0): {key_R}")
print(f"Clé S(0): {key_S}")
